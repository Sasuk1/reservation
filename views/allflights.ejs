<!-- index.html -->

<!DOCTYPE html>
<html>

<head>
    <title>Flights</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.2/css/jquery.dataTables.min.css">
</head>

<body style="padding: 100px;">
    <h1 style="text-align: center;">All Flights</h1>
    <table id="flightsTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Airline</th>
                <th>Destination</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <% flights.forEach(function(flight) { %>
            <!-- Flights data will be dynamically inserted here -->
            <tr style="text-align: center;">
                <td><%= flight.id %></td>
                <td><%= flight.airline %></td>
                <td><%= flight.destination %></td>
                <td><%= flight.status %></td>
                <td style="display: grid;">
                    <button onclick="updateFlightStatus('<%= flight.id %>','On time')" style="margin-bottom: 10px;display:<%= flight.status === 'On time' ? 'none' : 'block' %>;background:transparent;padding:5px;border:1px solid green">On time</button>
                    <button onclick="updateFlightStatus('<%= flight.id %>','Cancelled')" style="margin-bottom: 10px;display:<%= flight.status === 'Cancelled' ? 'none' : 'block' %>;background:transparent;padding:5px;border:1px solid red">Cancelled</button>
                    <button onclick="updateFlightStatus('<%= flight.id %>','Boarding')" style="margin-bottom: 10px;display:<%= flight.status === 'Boarding' ? 'none' : 'block' %>;background:transparent;padding:5px;border:1px solid darkblue">Boarding</button>
                    <button onclick="updateFlightStatus('<%= flight.id %>','Delayed')" style="margin-bottom: 10px;display:<%= flight.status === 'Delayed' ? 'none' : 'block' %>;background:transparent;padding:5px;border:1px solid orange">Delayed</button>
                </td>
            </tr>
            <% }); %>
        </tbody>
    </table>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.2/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // flights.js

        function updateFlightStatus(flightId, newStatus) {
            axios.put(`/Flights/updateFlightStatus?id=${flightId}&status=${newStatus}`)
                .then(response => {
                    console.log(response.data);
                    location.reload(); // Refresh the page after successful update
                })
                .catch(error => {
                    console.error(error);
                });
        }

        $(document).ready(function () {
            // Initialize DataTable
            $('#flightsTable').DataTable();
        });
    </script>
</body>

</html>
